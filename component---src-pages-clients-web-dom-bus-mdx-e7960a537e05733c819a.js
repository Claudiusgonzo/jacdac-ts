(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{aSOY:function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return M})),a.d(t,"default",(function(){return H}));a("rGqo"),a("yt8O"),a("Btvt"),a("RW0V"),a("91GP");var n=a("q1tI"),s=a.n(n),c=a("7ljp"),o=a("9Dj+"),r=(a("V+eJ"),a("8+KV"),a("KQm4")),p=a("wx14"),i=(a("17x9"),a("bv9d"));var b=function(e){var t=function(t){var a=e(t);return t.css?Object(p.a)(Object(p.a)({},Object(i.a)(a,e(Object(p.a)({theme:t.theme},t.css)))),function(e,t){var a={};return Object.keys(e).forEach((function(n){-1===t.indexOf(n)&&(a[n]=e[n])})),a}(t.css,[e.filterProps])):a};return t.propTypes={},t.filterProps=["css"].concat(Object(r.a)(e.filterProps)),t};a("DNiP");var m=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];var n=function(e){return t.reduce((function(t,a){var n=a(e);return n?Object(i.a)(t,n):t}),{})};return n.propTypes={},n.filterProps=t.reduce((function(e,t){return e.concat(t.filterProps)}),[]),n},l=(a("LK8F"),a("KKXr"),a("rePB")),u=a("LybE");function j(e,t){return t&&"string"==typeof t?t.split(".").reduce((function(e,t){return e&&e[t]?e[t]:null}),e):null}var O=function(e){var t=e.prop,a=e.cssProperty,n=void 0===a?e.prop:a,s=e.themeKey,c=e.transform,o=function(e){if(null==e[t])return null;var a=e[t],o=j(e.theme,s)||{};return Object(u.a)(e,a,(function(e){var t;return"function"==typeof o?t=o(e):Array.isArray(o)?t=o[e]||e:(t=j(o,e)||e,c&&(t=c(t))),!1===n?t:Object(l.a)({},n,t)}))};return o.propTypes={},o.filterProps=[t],o};function d(e){return"number"!=typeof e?e:"".concat(e,"px solid")}var g=m(O({prop:"border",themeKey:"borders",transform:d}),O({prop:"borderTop",themeKey:"borders",transform:d}),O({prop:"borderRight",themeKey:"borders",transform:d}),O({prop:"borderBottom",themeKey:"borders",transform:d}),O({prop:"borderLeft",themeKey:"borders",transform:d}),O({prop:"borderColor",themeKey:"palette"}),O({prop:"borderRadius",themeKey:"shape"})),N=m(O({prop:"displayPrint",cssProperty:!1,transform:function(e){return{"@media print":{display:e}}}}),O({prop:"display"}),O({prop:"overflow"}),O({prop:"textOverflow"}),O({prop:"visibility"}),O({prop:"whiteSpace"})),h=m(O({prop:"flexBasis"}),O({prop:"flexDirection"}),O({prop:"flexWrap"}),O({prop:"justifyContent"}),O({prop:"alignItems"}),O({prop:"alignContent"}),O({prop:"order"}),O({prop:"flex"}),O({prop:"flexGrow"}),O({prop:"flexShrink"}),O({prop:"alignSelf"}),O({prop:"justifyItems"}),O({prop:"justifySelf"})),f=m(O({prop:"gridGap"}),O({prop:"gridColumnGap"}),O({prop:"gridRowGap"}),O({prop:"gridColumn"}),O({prop:"gridRow"}),O({prop:"gridAutoFlow"}),O({prop:"gridAutoColumns"}),O({prop:"gridAutoRows"}),O({prop:"gridTemplateColumns"}),O({prop:"gridTemplateRows"}),O({prop:"gridTemplateAreas"}),O({prop:"gridArea"})),y=m(O({prop:"position"}),O({prop:"zIndex",themeKey:"zIndex"}),O({prop:"top"}),O({prop:"right"}),O({prop:"bottom"}),O({prop:"left"})),k=m(O({prop:"color",themeKey:"palette"}),O({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette"})),v=O({prop:"boxShadow",themeKey:"shadows"});function w(e){return e<=1?"".concat(100*e,"%"):e}var x=O({prop:"width",transform:w}),T=O({prop:"maxWidth",transform:w}),C=O({prop:"minWidth",transform:w}),K=O({prop:"height",transform:w}),S=O({prop:"maxHeight",transform:w}),A=O({prop:"minHeight",transform:w}),B=(O({prop:"size",cssProperty:"width",transform:w}),O({prop:"size",cssProperty:"height",transform:w}),m(x,T,C,K,S,A,O({prop:"boxSizing"}))),P=a("+Hmc"),D=m(O({prop:"fontFamily",themeKey:"typography"}),O({prop:"fontSize",themeKey:"typography"}),O({prop:"fontStyle",themeKey:"typography"}),O({prop:"fontWeight",themeKey:"typography"}),O({prop:"letterSpacing"}),O({prop:"lineHeight"}),O({prop:"textAlign"})),E=a("/P46"),I=a("cNwE"),W=function(e){var t=Object(E.a)(e);return function(e,a){return t(e,Object(p.a)({defaultTheme:I.a},a))}},U=b(m(g,N,h,f,y,k,v,B,P.b,D)),R=W("div")(U,{name:"MuiBox"}),z={margin:"1rem"},G=function(e){return s.a.createElement(R,{style:z},e.children)},J=a("nyfv");var M={},_={_frontmatter:M},q=o.a;function H(e){var t=e.components,a=function(e,t){if(null==e)return{};var a,n,s={},c=Object.keys(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||(s[a]=e[a]);return s}(e,["components"]);return Object(c.b)(q,Object.assign({},_,a,{components:t,mdxType:"MDXLayout"}),Object(c.b)("h1",null,"JDBus"),Object(c.b)("p",null,"The ",Object(c.b)("strong",{parentName:"p"},"bus")," is the top-level ",Object(c.b)("a",Object.assign({parentName:"p"},{href:"/jacdac-ts/clients/web/dom"}),"DOM")," element.\nIt processes the incoming and outcoming packets,\nhandles the connection to the underlying communiction transport\nand maintains a set of active ",Object(c.b)("a",Object.assign({parentName:"p"},{href:"/jacdac-ts/clients/web/device"}),"devices")," nodes."),Object(c.b)("h2",null,"WebUSB bus"),Object(c.b)("p",null,"The most common use is to create a bus that uses WebUSB to\ncommunicate to a physical JACDAC device. This is done with ",Object(c.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),"createUSBBus"),"."),Object(c.b)("div",{className:"gatsby-highlight","data-language":"javascript"},Object(c.b)("pre",Object.assign({parentName:"div"},{className:"language-javascript"}),Object(c.b)("code",Object.assign({parentName:"pre"},{className:"language-javascript"}),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"import")," ",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{")," createUSBBus ",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}")," ",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"from")," ",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"jacdac"'),"\n\n",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"const")," bus ",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"createUSBBus"),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";")))),Object(c.b)("h2",null,"Connection and disconnection"),Object(c.b)("p",null,"By default, the WebUSB bus will try to reconnect\nto any known connected physical device. The JACDAC physical device hasn't been paired yet,\nyou can initiate the connection from a user interaction handler (security measure as the user must manually pick the device)."),Object(c.b)("div",{className:"gatsby-highlight","data-language":"javascript"},Object(c.b)("pre",Object.assign({parentName:"div"},{className:"language-javascript"}),Object(c.b)("code",Object.assign({parentName:"pre"},{className:"language-javascript"}),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"await")," bus",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"connectAsync"),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";")))),Object(c.b)("p",null,"The bus will detect that the physical device is disconnected automatically. If you wish to disconnect manually, use"),Object(c.b)("div",{className:"gatsby-highlight","data-language":"javascript"},Object(c.b)("pre",Object.assign({parentName:"div"},{className:"language-javascript"}),Object(c.b)("code",Object.assign({parentName:"pre"},{className:"language-javascript"}),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"await")," bus",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"disconnectAsync"),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";")))),Object(c.b)("p",null,"You can query the status of the connection using ",Object(c.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),"bus.connectionState"),". The connection has 4 states:"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"connected: connected to a physical device over WebUSB and receiving packets"),Object(c.b)("li",{parentName:"ul"},"connection: connection in progress (for example, user is selecting the device)"),Object(c.b)("li",{parentName:"ul"},"disconnected: no active connection to a physical device"),Object(c.b)("li",{parentName:"ul"},"disconnecting: closing the connection to the physical device")),Object(c.b)("p",null,"Using the ",Object(c.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),"CONNECTION_STATE")," event, you can track changes of the state."),Object(c.b)("div",{className:"gatsby-highlight","data-language":"javascript"},Object(c.b)("pre",Object.assign({parentName:"div"},{className:"language-javascript"}),Object(c.b)("code",Object.assign({parentName:"pre"},{className:"language-javascript"}),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"import")," ",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{")," ",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token constant"}),"CONNECTION_STATE")," ",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}")," ",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"from")," ",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"jacdac"'),"\n\n",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token comment"}),"// am i in connected state?"),"\n",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"const")," connected ",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," bus",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"connected\nbus",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"on"),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token constant"}),"CONNECTION_STATE"),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token parameter"}),"state")," ",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=>")," console",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"log"),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"state",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")))),Object(c.b)(G,{mdxType:"Widget"},Object(c.b)(J.a,{mdxType:"ConnectButton"})),Object(c.b)("h2",null,"Devices"),Object(c.b)("p",null,"You can query the bus at any to receive a snapshot of the devices DOM."),Object(c.b)("div",{className:"gatsby-highlight","data-language":"javascript"},Object(c.b)("pre",Object.assign({parentName:"div"},{className:"language-javascript"}),Object(c.b)("code",Object.assign({parentName:"pre"},{className:"language-javascript"}),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"const")," devices ",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," bus",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"devices"),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"for"),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"const")," device ",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"of")," devices",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n    console",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"log"),Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"device",Object(c.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")))),Object(c.b)("h2",null,"Events"),Object(c.b)("p",null,"All bus state mutation are advertised by events. You can listen or subscribe to those events."),Object(c.b)("p",null,"TODO"))}H.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-clients-web-dom-bus-mdx-e7960a537e05733c819a.js.map